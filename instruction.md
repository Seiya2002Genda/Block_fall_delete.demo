このプロジェクトに進めていく上で直面した課題・修正の大まかな説明書

📘 Block Fall Down 開発記録・説明書
― ChatGPTと作者によるWin32 GUIテトリスの開発ドキュメント ―

🏗️ はじめに

このプロジェクト「Block Fall Down」は、C++とWindows API（Win32）を使用して、外部ライブラリに頼らずにGUIベースのテトリス風ゲームを構築することを目的としてスタートしました。
制作にあたっては、OpenAIのAIアシスタント「ChatGPT」と協力しながら、リアルタイムでコード設計・デバッグ・修正を繰り返し、段階的に完成度を高めていきました。

🔧 初期段階：
SFMLの除去とWin32への切り替え
当初は SFML を用いたGUI描画を検討していましたが、以下の理由から Win32ネイティブで描画する方針に変更：

SFMLのCMake連携や環境構築が煩雑だった

最小構成で動作するネイティブなTetrisを目指した

➡️ Win32 APIの FillRect, DrawEdge, TextOutA を活用するシンプルな描画設計へ切り替え。

🧱 ブロック設計と操作仕様の実装
次に、ゲームの基本仕様をChatGPTと相談しながら整理・実装：

ブロック形状追加（最初はT型のみ → L型・O型 → I型・J型も追加）

操作キーの決定：

W → 回転

A → 左

D → 右

マス目の描画 → DrawEdge によるグリッド表現を導入

📦 描画強化とプレビュー機能の追加

ChatGPTと何度も試行錯誤を繰り返し、以下を追加：

「Next」枠：次に出るブロックのプレビューを描画

スコア表示：1行消すごとに+100点

「Next」枠からのはみ出し修正：当初ブロックが枠外にはみ出していた問題を修正

グリッド強化：ブロックと背景の境界が見やすくなるように枠を調整

⏱️ ゲーム制限時間の導入（60秒）
ゲームをより緊張感あるものにするために、ChatGPTと相談して 60秒の制限タイマー を導入：

SetTimer を2つ使用（落下タイマーとカウントダウン用）

時間切れになると自動で MessageBox("Time's up!") 表示 → ゲーム終了

残り時間の表示を画面右下に配置

🧪 テスト・バグ修正
実装中に見つかった課題と修正例：

Game Over メッセージが無限に出続けるバグ
→ KillTimer + フラグで制御

FillRect のrvalueエラー（Win32では構造体のポインタ取得に注意が必要）
→ RECT を別途変数として定義し対応

プレビュー枠のサイズ調整ミス → 描画領域を+1ブロック分拡張

🤝 ChatGPTとの開発スタイル
このプロジェクトは、以下のような形式でChatGPTとのリアルタイム開発対話を通じて行われました：

Seiyaが実行ログや画像を提示 → ChatGPTが原因を分析し、コード改善を提案

「動かない」「落ちてこない」「はみ出す」といった具体的なフィードバックに対して即時修正案を提示

実装した機能を動作確認しながら、自然言語で改良リクエスト（「ここ直して」「Next見切れてる」など）を伝達

📄 完成機能一覧
機能	実装状況	備考
ブロック落下	✅	タイマーによる定期落下
ブロック回転	✅	O型は回転不可に設定
行の削除	✅	1行ごとに+100点
スコア表示	✅	画面右上に表示
次のブロック表示	✅	Preview枠付き
制限時間（60秒）	✅	カウントダウン表示あり
グリッド描画	✅	DrawEdge使用
📌 今後のアイデア
ハイスコアの記録とランキング

残り時間でボーナス加算

ブロック落下スピードの段階的加速

SE/BGMの追加（WinMM や DirectSound）

GUIでプレイヤー名入力・スタート画面追加

📝 ライセンスと作者
ライセンス：MIT License

制作者：Seiya Genda × ChatGPT (OpenAI)

開発開始：2025年4月
